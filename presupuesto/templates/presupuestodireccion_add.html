{% extends "base_modal_form.html" %}

{% block formulario %}

<form action="" method="post" id="myform">

  {% csrf_token %}

  <div class="form-group control-campos">

    {% if form.errors %}

    <p class="alert-danger alerta">Complete todos los campos y luego clic en registrar.</p>

    {% endif %}


{{form.as_p}}
  </div>
  <button type="submit" class="btn btn-default">Registrar</button>
</form>

{% endblock formulario %}

{% block style %}


<style>

{% if form.tipo_direccion.value = "Destino" %}

#s_lista_ocupacion, #s_total_m2 {
  display: none;
}

{% endif %}

@media (max-width:600px) {

  {% if form.tipo_direccion.value = "Destino" %}

  butto{position: absolute;bottom:-325px;}

  {% else %}

  butto{position: absolute;bottom:-400px;}

  {% endif %}

}

.radioselect-ul {
  display: block;
  list-style: none;
  padding: 0;
  width: 100%;
}

.radioselect-ul li {
  display: inline-table;
  margin: -3px;
  border: 1px solid #ccc;
}

.radioselect-ul li label {
  padding: 5px 10px;
  margin-bottom: 0;
  cursor: pointer;
}

.radioselect-ul li label input {
  width: 0;
  height: 0;
}

</style>

{% endblock style %}

{% block js_form %}

<script src="/static/js/presupuestoForm/preDireccion.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$('#myform').submit(function(){
    var action = "{% url 'upresupuestos:PresupuestoDireccionView' %}";
    var that = $(this);
    $.ajax({
        url: action,
        type: 'POST',
        data: that.serialize()
        ,success: function(data){
            var modalp = parent.document.getElementById('myModalDireccion');
            var divp = parent.document.getElementsByClassName("modal-backdrop");
            var bodyp = parent.document.getElementById('id_body');
            var closep = parent.document.getElementById("btn-cerrardir");
            var msj = parent.document.getElementById('msjGuardado');
          if (data.estatus=="ok"){
            $(closep).click();
            $(msj).text('Guardado con exito');
            $(msj).fadeIn();
            setTimeout(function() {
            parent.location.reload();
            },400);
          }
        }
    });
    return false;
});
});
function refresh() {
  var tipo_direccion = $("#id_tipo_direccion").val();
  var id_presupuesto = $("#id_presupuesto").val();
  var urldir = "";
  var iddiv = "";

  if (tipo_direccion=="Origen"){
    urldir = "/presupuesto/ficha/direccionorigen/"+ id_presupuesto;
    iddiv = 'direccion-origen';
  }else if(tipo_direccion=="Destino"){
    urldir = "/presupuesto/ficha/direcciondestino/"+ id_presupuesto;
    iddiv = 'direccion-destino';
  }
  $.ajax({
    url: urldir,
    success: function(data) {
      var divs = parent.document.getElementById(iddiv);
      $(divs).html(data);
    }
  });
}
</script>

{% endblock js_form %}
