{% extends 'base_modal_form.html' %}

{% block formulario %}

            <div class="modal-body">

                {% block validacion_modal %}

                <p>Â¿Desea eliminar el registro: <strong id="objeto">{{ object }}</strong>?</p>

                {% endblock validacion_modal %}

            </div>

{% endblock formulario %}

{% block js_form %}

<script>
var object = $(parent.document.getElementsByClassName("nombreEliminar")).text();
var myform = $(parent.document.getElementById("myform"));
$('#objeto').text(object);
myform.submit(function () {
    var id = $(parent.document.getElementsByClassName("id_opcionEliminar")).attr('src');
    var action = id;
    var that = $(this);
    $.ajax({
        url: action,
        type: 'POST',
        data: that.serialize(),
        success: function (data) {
            var closep = parent.document.getElementById("cerrarEliminar");
            var eliminar = parent.document.getElementById("msjEliminado");
          if (data.estatus=="ok") {
            cerrarModal(closep, eliminar);
            setTimeout(function () {
            parent.location.reload();
            }, 1000);
            $(eliminar).text(object + ' eliminado');
            $(eliminar).fadeIn();
          }else{
            alert('no se elimino ' + data.msj);
            cerrarModal(closep, eliminar);
          }
        },
        error: function (ajaxContext) {
        setTimeout(function() {
            cerrarModal(closep, eliminar);
        }, 1000);
        $(eliminar).text('No se puede eliminar ' + object);
        $(eliminar).fadeIn();
        setTimeout(function() {
            $(eliminar).fadeOut();
        }, 3000);
    }
    });
    return false;
});
</script>

{% endblock js_form %}
