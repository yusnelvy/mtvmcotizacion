{% extends 'base_modal_form.html' %}

{% block formulario %}

            <div id="status" class="modal-body">

                {% block validacion_modal %}

                <h4 >
                    Â¿Desea eliminar el registro:
                    <strong id="objeto">
                        {{ object }}
                    </strong>?
                </h4>

                {% endblock validacion_modal %}

            </div>

{% endblock formulario %}

{% block js_form %}

<script>
var object = $(parent.document.getElementsByClassName("nombreEliminar")).text();
var myform = $(parent.document.getElementById("myform"));
$('#objeto').text(object);
myform.submit(function () {
    var id = $(parent.document.getElementsByClassName("id_opcionEliminar")).attr('src');
    var action = id;
    var that = $(this);
    $.ajax({
        url: action,
        type: 'POST',
        data: that.serialize(),
        success: function (data) {
            var closep = parent.document.getElementById("cerrarEliminar");
            var eliminar = parent.document.getElementById("msjEliminado");
          if (data.estatus=="ok") {
            $(eliminar).addClass('alert alert-success msj notific');
            cerrarModal(closep, eliminar);
            setTimeout(function () {
            parent.location.reload();
            }, 500);
            $(eliminar).append("<span class='glyphicon glyphicon-ok-circle'></span> " + object + " eliminado ");
            $(eliminar).fadeIn();
          }else {
            cerrarModal(closep, eliminar);
            setTimeout(function () {
            $(eliminar).fadeOut();
            parent.location.reload();
            }, 3000);
            $(eliminar).addClass('alert alert-danger msj notific');
            $(eliminar).append("<span class='glyphicon glyphicon-ban-circle'></span> " + object + " no eliminado<p style='font-size: 12px;'>" + data.msj + "</p>");
            $(eliminar).fadeIn();
          }
        }
    });
    return false;
});
</script>

{% endblock js_form %}
