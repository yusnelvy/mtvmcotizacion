{% extends 'inicio/base_ficha.html' %}

{% block titulo %}

<title>Ficha &middot; Cotización</title>

{% endblock titulo %}

{% block titulo_ficha %}

<h2>Ficha de la Cotización</h2>

{% if det_complejidad %}

{% endif %}

{% endblock titulo_ficha %}

{% block titulo_modal %}

Eliminar Cotización

{% endblock titulo_modal %}

{% block validacion_modal %}

<p>¿Realmente desea eliminar el registro: <strong id="modal_name"></strong>?</p>

{% endblock validacion_modal %}

{% block link %}

<ul class="nav navbar-nav">
  <li>
    <a href="../../"><span class="glyphicon glyphicon-chevron-left"></span></a>
  </li>
</ul>

{% endblock link %}

{% block col1 %}

<div class="col-md-12">

  {% endblock col1 %}

  {% block content1 %}

  {% if buscar_cotizacion %}

  <div class="panel panel-default">
    <div class="panel-body">
      <div class="row">

        {% for i in buscar_cotizacion %}

        <div class="col-md-6">
          <h2 style="text-align: center;">

            {{ i.cliente.nombre_principal }}

            <br>
            <small>Telefono/Email{{ i.cliente.email }}</small>
          </h2>
        </div>
        <div class="col-md-3" style="text-align: justify;">
          <h3 >
            <small><strong>Fecha Cotización:</strong> {{ i.fecha_creacion|date:"d/m/Y" }} <br>
            </small>
            <small><strong>Fecha Mudanza:</strong> {{ i.fecha_estimadamudanza|date:"d/m/Y" }}</small><br>
            <small><strong>Cotizador:</strong> {{ i.cotizador }}</small>
          </h3>
        </div>

        <div class="col-md-3" style="text-align: justify;">
          <h3>
            <small><strong>N° Cotización:</strong> </small>{{ i.numero_cotizacion }}<br>
            <small><strong>N° Contrato:</strong> </small>{{ i.numero_contrato }}<br>
            <small><strong>Estado:</strong> </small>{{ i.estado }}
          </h3>
        </div>

        {% endfor %}

      </div><!-- row -->
    </div><!-- panel body -->
  </div><!-- panel default -->
  <div><!-- div sin class que cubre a los tab -->
    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
      <li role="presentation" class="active">
        <a href="#general" aria-controls="general" role="tab" data-toggle="tab">General</a>
      </li>
      <li role="presentation">
        <a href="#detalle" aria-controls="detalle" role="tab" data-toggle="tab">Detalles</a>
      </li>
      <li role="presentation">
        <a href="#infoadicional" aria-controls="infoadicional" role="tab" data-toggle="tab">Info Adicional</a>
      </li>
    </ul>
    <br>
    <!-- Tab panes -->
    <div class="tab-content">
      <div role="tabpanel" class="tab-pane fade in active" id="general">
        <div class="row">
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-body">
                <h4>Dirección Origen
                  <br>
                  <br>

                  {% if det_direccion %}

                  {% for det_dir in det_direccion %}

                  {% if det_dir.tipo_direccion == 'Origen' %}

                  <small>{{ det_dir.direccion }}</small>

                  {% endif %}

                  {% endfor %}

                  {% endif %}

                </h4>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-body">
                <h4>Dirección destino
                  <br>
                  <br>

                  {% if det_direccion %}

                  {% for det_dir in det_direccion %}

                  {% if det_dir.tipo_direccion == 'Destino' %}

                  <small>{{ det_dir.direccion }}</small>

                  {% endif %}

                  {% endfor %}

                  {% endif %}

                </h4>
              </div>
            </div>
          </div>
        </div><!-- row -->
        <div class="row">
          <div class="col-md-12">
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="row">

                  {% for i in buscar_cotizacion %}

                  <div class="col-md-4">
                    <h4>Resumen de la mudanza</h4>
                    <table class="table table-hover table-condensed">
                      <tr>
                        <td><strong>Cantidad de ambientes:</strong> </td>
                        <td class="text-right">{{ i.cantidad_ambientes }}</td>
                        <td>Und</td>
                      </tr>
                      <tr>
                        <td><strong>Cantidad de muebles: </strong></td>
                        <td class="text-right">{{ i.cantidad_muebles }}</td>
                        <td>Und</td>
                      </tr>
                      <tr>
                        <td><strong>Cantidad de contenedores: </strong></td>
                        <td class="text-right">{{ i.cantidad_contenedores }}</td>
                        <td>Und</td>
                      </tr>
                      <tr>
                        <td><strong>Volumen total: </strong></td>
                        <td class="text-right">9.00</td>
                        <td>m3</td>
                      </tr>
                      <tr>
                        <td><strong>Peso total: </strong></td>
                        <td class="text-right">9</td>
                        <td>Kg</td>
                      </tr>
                      <tr>
                        <td><strong>Tiempo estimado: </strong></td>
                        <td class="text-right">9</td>
                        <td>Horas</td>
                      </tr>
                      <tr>
                        <td><strong>Recorrido: </strong></td>
                        <td class="text-right">{{ i.total_recorrido_km }}</td>
                        <td>Km</td>
                      </tr>
                      <tr>

                        {% if det_vehiculo %}

                        {% for det_veh in det_vehiculo %}

                        <td><strong>Cantidad de vehiculos: </strong></td>
                        <td class="text-right">{{ det_veh.cantidad }}</td>
                        <td>Und</td>

                        {% endfor %}

                        {% endif %}

                      </tr>
                      <tr>
                        <td><strong>Cantidad de personas: </strong></td>
                        <td class="text-right">9</td>
                        <td>Und</td>
                      </tr>
                    </table>
                  </div>
                  <div class="col-md-4">
                    <h4>Detalle del inmueble</h4>
                    <div class="panel panel-default">
                      <table style="float:righ;" class="table table-condensed table-hover">
                        <tr>
                          <td><strong>Inmueble: </strong></td>
                          <td class="text-left">Edificio</td>
                        </tr>
                        <tr>
                          <td><strong>Tipo de inmueble: </strong></td>
                          <td class="text-left">Apartamento</td>
                        </tr>
                        <tr>
                          <td><strong>Complejidad: </strong></td>
                          <td>Media</td>
                        </tr>
                        <tr>
                          <td><strong>Distancia del vehiculo: </strong></td>
                          <td>0.05 Km</td>
                        </tr>
                      </table>
                    </div><!--fin panel panel-default-->
                  </div>
                  <div class="col-md-4" style="text-align:righ;">
                    <h4>Detalle del precio</h4>
                    <table style="float:righ;" class="table table-hover table-condensed">
                      <tr>
                        <td><strong>Muebles: </strong></td>
                        <td class="text-right">{{ i.monto_material }}</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Materiales:</strong> </td>
                        <td class="text-right">{{ i.monto_material }}</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Traslado:</strong></td>
                        <td class="text-right">10.00</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Personal:</strong></td>
                        <td class="text-right">330.00</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Servicio:</strong></td>
                        <td class="text-right" style="border-bottom: 1px solid #000;">40.00</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Total:</strong></td>
                        <td class="text-right">410</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Descuento:</strong></td>
                        <td class="text-right">{{ i.monto_descuento }}</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>Total:</strong></td>
                        <td class="text-right">{{ i.total_sin_impuesto }}</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>IVA:</strong></td>
                        <td class="text-right">49.20</td>
                        <td>$</td>
                      </tr>
                      <tr>
                        <td><strong>TOTAL:</strong></td>
                        <td class="text-right">{{ i.total_con_impuesto }}</td>
                        <td>$</td>
                      </tr>
                    </table>
                  </div>

                  {% endfor %}

                </div><!-- fin row -->
              </div>
            </div><!-- fin panel defaul-->
          </div><!-- fin col 12-->
        </div><!-- fin row -->
      </div> <!-- fin Tab panel general -->
      <div role="tabpanel" class="tab-pane fade" id="detalle">

        {% for i in det_ambiente %}

        <div class="panel panel-default">
          <div class="panel-body">
            <div class="row">
              <h4>
                <div class="col-md-3">
                  <p class="text-uppercase">{{ i.ambiente.ambiente }}</p>
                </div>
                <div class="col-md-5">
                  <small>Piso: {{ i.piso }} Muebles: {{ i.cantidad_muebles }} Contenedores: {{ i.cantidad_contenedores }} Peso: 200 Kg</small>
                </div>
                <div class="col-md-3">
                  <small>Observaciones: {{ i.observaciones }}</small>
                </div>
              </h4>
              <div class="col-md-1">
                <a style="float:right;color:#000;" data-toggle="collapse" data-target="#collapseExample{{i.id}}" aria-expanded="false" aria-controls="collapseExample{{i.id}}">
                  Ver muebles
                </a>
              </div>
            </div>
            <br>
            <div class="collapse" id="collapseExample{{i.id}}">
              <div class="">
                <div class="panel-group" id="accordion{{i.id}}" role="tablist" aria-multiselectable="true">

                  {% if det_mueble %}

                  {% for det_mue in det_mueble %}

                  {% if det_mue.cotizacion_ambiente == i %}

                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingOne{{det_mue.id}}">
                      <h4 class="panel-title">
                        <div class="row">
                          <div class="col-md-4">
                            <a class="text-uppercase" role="button" data-toggle="collapse" data-parent="#accordion{{i.id}}" href="#collapseOne{{det_mue.id}}" aria-expanded="true" aria-controls="collapseOne{{det_mue.id}}" style="color:#000;">{{ det_mue.mueble }}</a>
                          </div><!--col 4-->
                          <div class="col-md-5">

                            <small>{{ det_mue.forma }} {{ det_mue.tamano }} {{ det_mue.peso }} Kg {{ det_mue.ancho }}x{{ det_mue.largo }}x{{ det_mue.alto }}</small>

                            {% if det_servicio %}

                            <small>

                              {% for det_ser in det_servicio %}

                              {% if det_ser.cotizacion_mueble == det_mue %}

                              {{det_ser.servicio }}

                              {% endif %}

                              {% endfor %}

                            </small>

                            {% endif %}

                          </div>
                          <div class="col-md-3">
                            <small>- Total: $ 307</small>
                            <a role="button" data-toggle="collapse" data-parent="#accordion{{i.id}}" href="#collapseOne{{det_mue.id}}" aria-expanded="true" aria-controls="collapseOne{{det_mue.id}}" style="float:right;color:#000;">Ver mas</a>
                          </div>
                        </div><!--fin row-->
                      </h4>
                    </div>
                    <div id="collapseOne{{det_mue.id}}" class="panel-collapse collapse " role="tabpanel" aria-labelledby="headingOne{{det_mue.id}}">
                      <div class="panel-body">
                        <div class="row">
                          <div class="col-md-8">
                            <table class="table table-condensed table-bordered" style="text-align: center;">
                              <tr>
                                <th>Forma</th>
                                <th>Tamaño</th>
                                <th>Peso</th>
                                <th>A</th>
                                <th>L</th>
                                <th>A</th>
                              </tr>
                              <tr>
                                <td>{{ det_mue.forma }}</td>
                                <td>{{ det_mue.tamano }}</td>
                                <td>{{ det_mue.peso }} Kg</td>
                                <td>{{ det_mue.ancho }} cm</td>
                                <td>{{ det_mue.largo }} cm</td>
                                <td>{{ det_mue.alto }} cm</td>
                              </tr>
                            </table>
                            <table class="table table-condensed table-bordered" style="text-align: center;">
                              <tr>
                                <th>Volumen</th>
                                <th>Densidad</th>
                                <th>Ocupación</th>
                                <th>Vol. ocupación</th>
                                <th>Capacidad</th>
                                <th>Tipo de mueble</th>
                              </tr>
                              <tr>
                                <td>{{ det_mue.volumen }} m3</td>
                                <td>{{ det_mue.densidad }} Kg/m3</td>
                                <td>{{ det_mue.ocupacion }}%</td>
                                <td>1.00 m3</td>
                                <td>{{ det_mue.capacidad }} m3</td>
                                <td>{{ det_mue.mueble.tipo_mueble }}</td>
                              </tr>
                            </table>
                          </div>
                          <div class="col-md-4">
                            <table class="table table-condensed table-bordered" style="text-align: center;">
                              <tr>
                                <td colspan="2"><strong>Observación:</strong>
                                  <p>{{ det_mue.observaciones }}</p></td>
                                </tr>
                              </table>
                              <table class="table table-condensed table-bordered" style="text-align: center;">
                                <tr>
                                  <td>{{ det_mue.trasladable|yesno:"Trasladable,No Trasladable" }}</td>
                                  <td>{{ det_mue.apilable|yesno:"Apilable,No apilable" }}</td>
                                </tr>
                                <tr>
                                  <td>{{ det_mue.capacidad_carga|yesno:"Con capacidad de carga,Sin capacidad de carga" }}</td>
                                  <td>{{ det_mue.capacidad_interna|yesno:"Con capacidad interna,Sin capacidad interna" }}</td>
                                </tr>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-3">
                              <h4>Servicios</h4>
                              <table class="table table-condensed table-bordered" style="text-align: center;">
                                <tr>
                                  <th>Aplica a</th>
                                  <th>Servicio</th>
                                  <th>Compld</th>
                                  <th>Precio</th>
                                </tr>

                                {% if det_servicio %}

                                {% for det_ser in det_servicio %}

                                {% if det_ser.cotizacion_mueble == det_mue %}

                                <tr>
                                  <td>Mueble</td>
                                  <td>{{ det_ser.servicio }}</td>
                                  <td>{{ det_ser.tarifa }}</td>
                                  <td>$</td>
                                </tr>

                                {% endif %}<!--if  det_ser.cotizacion_mueble-->

                                {% endfor %}

                                {% endif %}<!--if servicio-->

                                {% if det_contenido %}

                                {% for det_cont in det_contenido %}

                                {% if det_cont.cotizacion_mueble == det_mue %}

                                {% if det_servicio_contenido %}

                                {% for det_sercon in det_servicio_contenido %}

                                {% if det_sercon.cotizacion_contenido.id == det_cont.id %}

                                <tr>
                                  <td>Contenido</td>
                                  <td>{{det_sercon.servicio }}</td>
                                  <td></td>
                                  <td>$</td>
                                </tr>

                                {% endif %}

                                {% endfor %}

                                {% endif %}

                                {% endif %}

                                {% endfor %}

                                <th colspan="3">Total:</th>
                                <th>$ 65</th>

                                {% endif %}

                              </table>
                            </div>
                            <div class="col-md-5">
                              <h4>Materiales</h4>
                              <table class="table table-condensed table-bordered" style="text-align: center;">
                                <tr>
                                  <th>Aplica a</th>
                                  <th>Material</th>
                                  <th>Cantidad</th>
                                  <th>Peso</th>
                                  <th>Retornable</th>
                                  <th>Precio</th>
                                </tr>

                                {% if det_servicio %}

                                {% for det_ser in det_servicio %}

                                {% if det_ser.cotizacion_mueble == det_mue %}

                                {% if det_material %}

                                {% for det_mat in det_material %}

                                {% if det_mat.cotizacion_servicio == det_ser %}

                                <tr>
                                  <td>Mueble</td>
                                  <td>{{ det_mat.material }}</td>
                                  <td>{{ det_mat.cantidad }} Und</td>
                                  <td>{{ det_mat.peso_total }} Kg</td>
                                  <td>{{ det_mat.recuperable |yesno:"Si,No" }}</td>
                                  <td>$ {{ det_mat.precio_total }}</td>
                                </tr>

                                {% endif %}

                                {% endfor %}

                                {% endif %}<!--if material-->

                                {% endif %}<!--if  det_ser.cotizacion_mueble-->

                                {% endfor %}

                                {% endif %}<!--if servicio-->

                                {% if det_contenido %}

                                {% for det_cont in det_contenido %}

                                {% if det_cont.cotizacion_mueble == det_mue %}

                                {% if det_servicio_contenido %}

                                {% for det_sercon in det_servicio_contenido %}

                                {% if det_sercon.cotizacion_contenido.id == det_cont.id %}

                                {% if det_material %}

                                {% for det_mat in det_material %}

                                {% if det_mat.cotizacion_servicio.id == det_sercon.id %}

                                <tr>
                                  <td>Contenido</td>
                                  <td>{{ det_mat.material }}</td>
                                  <td>{{ det_mat.cantidad }} Und</td>
                                  <td>{{ det_mat.peso_total }} Kg</td>
                                  <td>{{ det_mat.recuperable |yesno:"Si,No" }}</td>
                                  <td>$ {{ det_mat.precio_total }}</td>
                                </tr>

                                {% endif %}

                                {% endfor %}

                                {% endif %}<!--if material del servicio del contenido-->

                                {% endif %}

                                {% endfor %}

                                {% endif %}

                                {% endif %}

                                {% endfor %}

                                <th colspan="5">Total:</th>
                                <th>$ 65</th>

                                {% endif %}

                              </table>
                            </div>
                            <div class="col-md-4">
                              <h4>Contenido</h4>
                              <table class="table table-condensed table-bordered" style="text-align: center;">
                                <tr>
                                  <th>Contenido</th>
                                  <th>Densidad</th>
                                  <th>Vol</th>
                                  <th>Peso</th>
                                  <th>%</th>
                                </tr>

                                {% if det_contenido %}

                                {% for det_cont in det_contenido %}

                                {% if det_cont.cotizacion_mueble == det_mue %}

                                <tr>
                                  <td>{{ det_cont.contenido }}</td>
                                  <td>{{ det_cont.densidad }}</td>
                                  <td>{{ det_cont.volumen_contenido }} m3</td>
                                  <td>{{ det_cont.peso_contenido }} Kg</td>
                                  <td>{{ det_cont.porcentaje }}%</td>
                                </tr>

                                {% endif %}

                                {% endfor %}

                                <th colspan="2">Total: </th>
                                <th>0.5 m3</th>
                                <th>70 Kg</th>
                                <th>100%</th>

                                {% endif %}

                              </table>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {% endif %}

                    {% endfor %}

                    {% endif %}

                  </div><!--fin acordion-->
                </div><!--fin well simulado -->
                <div class="row">
                  <div class="col-md-4"></div><!--col 4-->
                  <div class="col-md-5"></div>
                  <div class="col-md-3">
                    <small>TOTAL: $ 512</small>
                    <a style="float:right;color:#000;" data-toggle="collapse" data-target="#collapseExample{{i.id}}" aria-expanded="false" aria-controls="collapseExample{{i.id}}">
                      Cerrar
                    </a>
                  </div>
                </div><!--fin row total ambiente-->
              </div><!--fin colapsable ambiente -->
            </div>
          </div><!--fin panel default del ambiente-->

          {% endfor %}

        </div><!-- fin Tab panes detalle -->
        <div role="tabpanel" class="tab-pane fade" id="infoadicional">informacion adicional en construccion</div>
      </div>
    </div><!-- div sin class que cubre a los tab -->
    <div class="row">
      <div class="col-md-4">
        <div class="panel panel-default">
          <div class="panel-body">
            <p>
              Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen.
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="panel panel-default">
          <div class="panel-body">
            <p>
              Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen.
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="panel panel-default">
          <div class="panel-body">
            <p>
              Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen.
            </p>
          </div>
        </div>
      </div>
    </div><!-- fin row -->

    {% endif %}

    {% endblock content1 %}
